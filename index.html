<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My tests | Ù…Ø³ØªÙˆÙŠØ§Øª Ø§Ù„Ø°ÙƒØ§Ø¡ ÙˆØ§Ù„ØªØ­Ù„ÙŠÙ„</title>
    <style>
        :root {
            --neon-purple: #bc13fe;
            --neon-blue: #08f7fe;
            --correct: #39ff14;
            --wrong: #ff3131;
            --bg: #0d0221;
        }
        * { box-sizing: border-box; }
        body {
            background-color: var(--bg);
            color: white;
            font-family: 'Segoe UI', Tahoma, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            overflow-x: hidden;
        }

        .brain-logo {
            width: 100px;
            height: 100px;
            margin: 0 auto 15px;
            display: block;
            filter: drop-shadow(0 0 12px var(--neon-blue));
            animation: pulse-glow 2s infinite alternate;
        }
        @keyframes pulse-glow {
            from { filter: drop-shadow(0 0 5px var(--neon-blue)); transform: scale(1); }
            to { filter: drop-shadow(0 0 25px var(--neon-blue)); transform: scale(1.05); }
        }

        .card {
            background: rgba(255, 255, 255, 0.05);
            padding: 30px;
            border-radius: 20px;
            border: 2px solid var(--neon-purple);
            box-shadow: 0 0 20px var(--neon-purple);
            width: 90%;
            max-width: 600px;
            text-align: center;
            animation: fadeIn 0.5s ease-in;
        }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        
        input[type="text"] {
            background: transparent; border: 2px solid var(--neon-blue); border-radius: 10px;
            padding: 12px; color: white; width: 100%; margin-bottom: 15px; text-align: center; font-size: 1rem; outline: none;
            transition: 0.3s;
        }
        
        .btn {
            background: transparent; color: white; border: 2px solid var(--neon-blue);
            padding: 15px; margin: 8px 0; width: 100%; border-radius: 12px;
            cursor: pointer; font-size: 1.1rem; transition: 0.3s; box-shadow: inset 0 0 5px var(--neon-blue);
        }
        .btn:hover { box-shadow: 0 0 20px var(--neon-blue); background: rgba(8, 247, 254, 0.1); }
        .level-btn { border-color: #f708ff; box-shadow: inset 0 0 5px #f708ff; }
        .level-btn:hover { box-shadow: 0 0 20px #f708ff; }
        
        .order-box { display: flex; flex-wrap: wrap; justify-content: center; gap: 10px; margin: 20px 0; }
        .order-btn { background: rgba(188, 19, 254, 0.2); border: 1px dashed var(--neon-purple); color: white; padding: 10px 20px; border-radius: 8px; cursor: pointer; transition: 0.3s; }
        .order-btn.selected { opacity: 0.3; pointer-events: none; transform: scale(0.9); }
        
        .psy-item { border-bottom: 1px solid rgba(8, 247, 254, 0.2); padding: 8px 0; font-size: 0.95rem; text-align: right; }
        .psy-item b { color: var(--neon-blue); }

        .hidden { display: none !important; }
        .correct-glow { border-color: var(--correct) !important; box-shadow: 0 0 30px var(--correct) !important; background: rgba(57, 255, 20, 0.2) !important; }
        .wrong-glow { border-color: var(--wrong) !important; box-shadow: 0 0 30px var(--wrong) !important; background: rgba(255, 49, 49, 0.2) !important; }
        
        #analysis-box { text-align: right; line-height: 1.8; background: rgba(255, 255, 255, 0.08); padding: 20px; border-radius: 15px; margin-top: 20px; border: 1px solid rgba(255,255,255,0.1); }
        .report-item { background: rgba(255, 49, 49, 0.1); padding: 10px; margin-bottom: 10px; border-right: 4px solid var(--wrong); border-radius: 5px; font-size: 0.9rem; }
        .tests-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 20px; }
    </style>
</head>
<body>

    <div class="card" id="name-view">
        <svg class="brain-logo" viewBox="0 0 64 64">
            <g stroke="#08f7fe" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" fill="none">
                <path d="M31 52C22 52 14 46 12 34C10 22 18 12 31 10V52Z" />
                <path d="M33 52C42 52 50 46 52 34C54 22 46 12 33 10V52Z" />
            </g>
        </svg>
        <h1 style="color: var(--neon-blue);">My tests</h1>
        <p>Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ.. Ù…Ø§ Ù‡Ùˆ Ø§Ø³Ù…ÙƒØŸ</p>
        <input type="text" id="user-name" placeholder="Ø§Ø¯Ø®Ù„ Ø§Ø³Ù…Ùƒ">
        <button class="btn" onclick="goToMain()">Ø¨Ø¯Ø¡ Ø§Ù„Ø±Ø­Ù„Ø©</button>
    </div>

    <div class="card hidden" id="main-view">
        <h2 id="welcome-msg"></h2>
        <button class="btn" onclick="showLevels()">Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø°ÙƒØ§Ø¡ (Ù…Ø³ØªÙˆÙŠØ§Øª)</button>
        <button class="btn" style="border-color: #39ff14;" onclick="showPsyLevels()">Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù†ÙØ³ÙŠ (Ø£Ù‚Ø³Ø§Ù…)</button>
    </div>

    <div class="card hidden" id="levels-view">
        <h2 style="color: #f708ff;">Ø§Ø®ØªØ± Ù…Ø³ØªÙˆÙ‰ Ø§Ù„ØµØ¹ÙˆØ¨Ø©</h2>
        <button class="btn level-btn" onclick="listTests('iq_easy')">Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø³Ù‡Ù„</button>
        <button class="btn level-btn" onclick="listTests('iq_med')">Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ù…ØªÙˆØ³Ø·</button>
        <button class="btn level-btn" onclick="listTests('iq_hard')">Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø¹Ø¨Ù‚Ø±ÙŠ</button>
        <button class="btn" onclick="backToMain()" style="border-color: gray; margin-top: 10px;">Ø±Ø¬ÙˆØ¹</button>
    </div>

    <div class="card hidden" id="tests-list-view">
        <h2 id="current-level-title" style="color: var(--neon-blue);">Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø©</h2>
        <div class="tests-grid" id="tests-buttons-container"></div>
        <button class="btn" id="back-from-list" style="border-color: gray; margin-top: 20px;">Ø±Ø¬ÙˆØ¹</button>
    </div>

    <div class="card hidden" id="quiz-view">
        <h2 id="question-text" style="min-height: 80px;"></h2>
        <div id="options-container"></div>
        <p style="color: var(--neon-blue); margin-top: 20px;">Ø§Ù„Ø³Ø¤Ø§Ù„ <span id="q-num">1</span> / 10</p>
    </div>

    <div class="card hidden" id="deep-psy-q1">
        <h2 style="color: var(--neon-blue);">Ø§Ù„Ù…Ø±Ø­Ù„Ø© 1: ØªØ±ØªÙŠØ¨ Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ§Øª</h2>
        <p>Ø±ØªØ¨ Ø§Ù„Ø­ÙŠÙˆØ§Ù†Ø§Øª Ø§Ù„ØªØ§Ù„ÙŠØ© Ø­Ø³Ø¨ Ø£Ù‡Ù…ÙŠØªÙ‡Ø§ ÙÙŠ Ø­ÙŠØ§ØªÙƒ (Ø§Ø¶ØºØ· Ø¨Ø§Ù„ØªØ±ØªÙŠØ¨):</p>
        <div class="order-box">
            <div class="order-btn" onclick="selectAnimal('Ø­ØµØ§Ù†', this)">Ø­ØµØ§Ù†</div>
            <div class="order-btn" onclick="selectAnimal('Ø®Ø±ÙˆÙ', this)">Ø®Ø±ÙˆÙ</div>
            <div class="order-btn" onclick="selectAnimal('Ø¨Ù‚Ø±Ø©', this)">Ø¨Ù‚Ø±Ø©</div>
            <div class="order-btn" onclick="selectAnimal('Ù†Ù…Ø±', this)">Ù†Ù…Ø±</div>
            <div class="order-btn" onclick="selectAnimal('Ø®Ù†Ø²ÙŠØ±', this)">Ø®Ù†Ø²ÙŠØ±</div>
        </div>
        <p id="user-order-display" style="color: var(--neon-purple); font-weight: bold;"></p>
        <button class="btn hidden" id="btn-to-psy2" onclick="switchView('deep-psy-q1', 'deep-psy-q2')">Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„ØªØ§Ù„ÙŠØ©</button>
    </div>
    <div class="card hidden" id="deep-psy-q2">
        <h2 style="color: var(--neon-blue);">Ø§Ù„Ù…Ø±Ø­Ù„Ø© 2: Ø±Ù…Ø²ÙŠØ© Ø§Ù„Ø£Ø´ÙŠØ§Ø¡</h2>
        <p>Ø§ÙƒØªØ¨ ØµÙØ© ÙˆØ§Ø­Ø¯Ø© ØªØµÙ Ø¨Ù‡Ø§ ÙƒÙ„ Ù…Ù…Ø§ ÙŠÙ„ÙŠ:</p>
        <input type="text" id="psy-dog" placeholder="Ø§Ù„ÙƒÙ„Ø¨ Ù‡Ùˆ...">
        <input type="text" id="psy-cat" placeholder="Ø§Ù„Ù‚Ø·Ø© Ù‡ÙŠ...">
        <input type="text" id="psy-rat" placeholder="Ø§Ù„ÙØ£Ø± Ù‡Ùˆ...">
        <input type="text" id="psy-coffee" placeholder="Ø§Ù„Ù‚Ù‡ÙˆØ© Ù‡ÙŠ...">
        <input type="text" id="psy-sea" placeholder="Ø§Ù„Ø¨Ø­Ø± Ù‡Ùˆ...">
        <button class="btn" onclick="switchView('deep-psy-q2', 'deep-psy-q3')">Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„ØªØ§Ù„ÙŠØ©</button>
    </div>
    <div class="card hidden" id="deep-psy-q3">
        <h2 style="color: var(--neon-blue);">Ø§Ù„Ù…Ø±Ø­Ù„Ø© 3: Ø§Ù„Ø£Ù„ÙˆØ§Ù† ÙˆØ§Ù„Ù†Ø§Ø³</h2>
        <p>Ø§ÙƒØªØ¨ Ø§Ø³Ù… Ø´Ø®Øµ ÙŠÙ…Ø«Ù„ Ù„Ùƒ ÙƒÙ„ Ù„ÙˆÙ† Ù…Ù† Ø§Ù„Ø£Ù„ÙˆØ§Ù† Ø§Ù„ØªØ§Ù„ÙŠØ©:</p>
        <input type="text" id="psy-yellow" placeholder="Ø£ØµÙØ±">
        <input type="text" id="psy-orange" placeholder="Ø¨Ø±ØªÙ‚Ø§Ù„ÙŠ">
        <input type="text" id="psy-red" placeholder="Ø£Ø­Ù…Ø±">
        <input type="text" id="psy-white" placeholder="Ø£Ø¨ÙŠØ¶">
        <input type="text" id="psy-green" placeholder="Ø£Ø®Ø¶Ø±">
        <button class="btn" onclick="showDeepResults()">Ø±Ø¤ÙŠØ© Ø§Ù„ØªØ­Ù„ÙŠÙ„</button>
    </div>

    <div class="card hidden" id="psy-traits-view">
        <h2 style="color: var(--neon-blue);">ØªØ­Ù„ÙŠÙ„ Ø§Ù„ØµÙØ§Øª Ø§Ù„Ø¨Ø§Ø·Ù†ÙŠØ©</h2>
        <input type="text" id="t-anim1" placeholder="Ø§Ø®ØªØ§Ø± Ø­ÙŠÙˆØ§Ù† ØªØ­Ø¨Ù‡ ÙˆØ§ÙƒØªØ¨ Ù…Ø¹Ù‡ Ø«Ù„Ø§Ø« ØµÙØ§Øª">
        <input type="text" id="t-anim2" placeholder="Ø§Ø®ØªØ§Ø± Ø­ÙŠÙˆØ§Ù† Ø«Ø§Ù†ÙŠ ÙˆØ§ÙƒØªØ¨ Ù…Ø¹Ù‡ Ø«Ù„Ø§Ø« ØµÙØ§Øª">
        <input type="text" id="t-anim3" placeholder="Ø§Ø®ØªØ§Ø± Ø­ÙŠÙˆØ§Ù† Ø«Ø§Ù„Ø« ÙˆØ§ÙƒØªØ¨ Ù…Ø¹Ù‡ Ø«Ù„Ø§Ø« ØµÙØ§Øª">
        <input type="text" id="t-wall" placeholder="Ø§ÙƒØªØ¨ Ø«Ù„Ø§Ø« ØµÙØ§Øª ØªÙˆØµÙ ÙƒÙ„Ù…Ø© 'Ø¬Ø¯Ø§Ø±'">
        <input type="text" id="t-well" placeholder="Ø§ÙƒØªØ¨ Ø«Ù„Ø§Ø« ØµÙØ§Øª ØªÙˆØµÙ ÙƒÙ„Ù…Ø© 'Ø¨Ø¦Ø±'">
        <input type="text" id="t-sea2" placeholder="Ø§ÙƒØªØ¨ Ø«Ù„Ø§Ø« ØµÙØ§Øª ØªÙˆØµÙ ÙƒÙ„Ù…Ø© 'Ø¨Ø­Ø±'">
        <button class="btn" onclick="showTraitsResults()">ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø§Øª</button>
    </div>

    <div class="card hidden" id="result-view">
        <h2 id="result-title">Ø§Ù„Ù†ØªÙŠØ¬Ø©</h2>
        <h1 id="score-header"></h1>
        <div id="analysis-box">
            <div id="analysis-text"></div>
            <div id="report-container"></div>
        </div>
        <div style="display: flex; gap: 10px; margin-top: 20px;">
            <button class="btn" id="btn-back-to-list" style="border-color: var(--neon-blue);">Ø±Ø¬ÙˆØ¹ Ù„Ù„Ø£Ù‚Ø³Ø§Ù…</button>
            <button class="btn" onclick="forceBackToHome()" style="border-color: var(--neon-purple);">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>
        </div>
    </div>

    <script>
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        function playTone(freq, type, duration) {
            const osc = audioCtx.createOscillator(); const gain = audioCtx.createGain();
            osc.type = type; osc.frequency.setValueAtTime(freq, audioCtx.currentTime);
            gain.gain.setValueAtTime(0.05, audioCtx.currentTime);
            osc.connect(gain); gain.connect(audioCtx.destination);
            osc.start(); osc.stop(audioCtx.currentTime + duration);
        }
        const sounds = {
            click: () => playTone(600, 'sine', 0.1),
            correct: () => { playTone(800, 'sine', 0.1); setTimeout(()=>playTone(1200, 'sine', 0.1), 100); },
            wrong: () => { playTone(300, 'sawtooth', 0.2); },
            success: () => { [440, 554, 659, 880].forEach((f, i) => setTimeout(() => playTone(f, 'sine', 0.2), i*150)); }
        };

        let userName = "";
        let activeQuestions = [];
        let currentLevelKey = ""; 
        let currentIdx = 0, score = 0, wrongAnswers = [];
        let deepAnimalOrder = [];

        const questionsBank = {
            iq_easy: [
                { q: "Ù…Ø§ Ù‡Ùˆ Ø§Ù„Ø¹Ø¯Ø¯ Ø§Ù„Ø°ÙŠ ÙŠÙƒÙ…Ù„ Ø§Ù„Ø³Ù„Ø³Ù„Ø©: 5ØŒ 10ØŒ 15ØŒ ...ØŸ", options: ["20", "25", "30"], correct: 0 },
                { q: "Ø£ÙŠÙ‡Ù…Ø§ Ø£Ø«Ù‚Ù„: ÙƒÙŠÙ„Ùˆ Ø­Ø¯ÙŠØ¯ Ø£Ù… ÙƒÙŠÙ„Ùˆ Ù‚Ø·Ù†ØŸ", options: ["Ø§Ù„Ø­Ø¯ÙŠØ¯", "Ø§Ù„Ù‚Ø·Ù†", "Ù…ØªØ³Ø§ÙˆÙŠØ§Ù†"], correct: 2 },
                { q: "ÙƒÙ… ÙŠÙˆÙ… ÙÙŠ 4 Ø£Ø³Ø§Ø¨ÙŠØ¹ØŸ", options: ["24", "28", "30"], correct: 1 },
                { q: "Ù…Ø§ Ù‡Ùˆ Ø§Ù„Ø¹Ø¯Ø¯ Ø§Ù„Ø°ÙŠ Ø¨Ø¹Ø¯ 999ØŸ", options: ["1000", "1100", "991"], correct: 0 },
                { q: "ÙƒÙ… Ø´Ù‡Ø±Ø§Ù‹ ÙÙŠ Ø§Ù„Ø³Ù†Ø© ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ 28 ÙŠÙˆÙ…Ø§Ù‹ØŸ", options: ["Ø´Ù‡Ø± ÙˆØ§Ø­Ø¯", "ÙƒÙ„ Ø§Ù„Ø´Ù‡ÙˆØ±", "Ø´Ù‡Ø±ÙŠÙ†"], correct: 1 },
                { q: "Ù…Ø§ Ù‡Ùˆ Ø¹ÙƒØ³ ÙƒÙ„Ù…Ø© 'Ù†Ø§Ø¯Ø±'ØŸ", options: ["Ù‚Ù„ÙŠÙ„", "Ø´Ø§Ø¦Ø¹", "Ù…Ø³ØªØ­ÙŠÙ„"], correct: 1 },
                { q: "ÙƒÙ… Ø¯Ù‚ÙŠÙ‚Ø© ÙÙŠ 3 Ø³Ø§Ø¹Ø§ØªØŸ", options: ["120", "180", "200"], correct: 1 },
                { q: "Ù…Ø§ Ù‡Ùˆ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø°ÙŠ ÙŠØ³Ø¨Ù‚ 500ØŸ", options: ["499", "490", "501"], correct: 0 },
                { q: "ÙƒÙ… Ø´Ù‡Ø± ÙÙŠ Ù†ØµÙ Ø³Ù†Ø©ØŸ", options: ["4", "5", "6"], correct: 2 },
                { q: "1000 â€“ 250 = ØŸ", options: ["650", "750", "800"], correct: 1 },
                { q: "Ù…Ø§ Ù‡Ùˆ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø°ÙŠ Ø¥Ø°Ø§ Ù‚Ù„Ø¨ØªÙ‡ ÙŠØµØ¨Ø­ Ù†ÙØ³Ù‡ØŸ", options: ["6", "8", "9"], correct: 1 },
                { q: "ÙƒÙ… Ø¶Ù„Ø¹ Ù„Ù„Ù…Ø«Ù„Ø«ÙŠÙ† Ù…Ø¹Ù‹Ø§ØŸ", options: ["3", "6", "9"], correct: 1 },
                { q: "Ù…Ø§ Ù‡Ùˆ Ø§Ù„Ø¹Ø¯Ø¯ Ø§Ù„ÙØ±Ø¯ÙŠ Ø¨ÙŠÙ† 100 Ùˆ102ØŸ", options: ["99", "101", "103"], correct: 1 },
                { q: "Ù…Ø§ Ù‡Ùˆ Ù†Ø§ØªØ¬ 81 Ã· 9 ØŸ", options: ["7", "8", "9"], correct: 2 },
                { q: "Ø¥Ø°Ø§ ÙƒØ§Ù† Ù„Ø¯ÙŠÙƒ 12 ÙƒØ±Ø© ÙˆØ£Ø®Ø°Øª 5ØŒ ÙƒÙ… ÙŠØªØ¨Ù‚Ù‰ØŸ", options: ["12", "7", "5"], correct: 1 },
                { q: "ÙƒÙ… Ø«Ø§Ù†ÙŠØ© ÙÙŠ 5 Ø¯Ù‚Ø§Ø¦Ù‚ØŸ", options: ["150", "300", "500"], correct: 1 },
                { q: "Ù…Ø§ Ù‡Ùˆ Ø§Ù„Ø¹Ø¯Ø¯ Ø§Ù„ØªØ§Ù„ÙŠ: 100 â€“ 90 â€“ 80 â€“ 70 â€“ ØŸ", options: ["65", "60", "50"], correct: 1 },
                { q: "45 Ã· 5 = ØŸ", options: ["8", "9", "10"], correct: 1 },
                { q: "Ù…Ø§ Ù‡Ùˆ Ø±Ø¨Ø¹ 64ØŸ", options: ["12", "14", "16"], correct: 2 },
                { q: "18 + 22 = ØŸ", options: ["30", "40", "50"], correct: 1 }
            ],
            iq_med: [
                { q: "Ù…Ø§ Ù‡Ùˆ Ø§Ù„Ø¹Ø¯Ø¯ Ø§Ù„ØªØ§Ù„ÙŠ: 3 â€“ 6 â€“ 12 â€“ 24 â€“ ØŸ", options: ["36", "48", "60"], correct: 1 },
                { q: "Ø¥Ø°Ø§ ÙƒØ§Ù† 5 Ø¹Ù…Ø§Ù„ ÙŠÙ†Ø¬Ø²ÙˆÙ† Ø¹Ù…Ù„Ø§Ù‹ ÙÙŠ 10 Ø£ÙŠØ§Ù…ØŒ ÙƒÙ… ÙŠØ­ØªØ§Ø¬ 10 Ø¹Ù…Ø§Ù„ØŸ", options: ["5 Ø£ÙŠØ§Ù…", "10 Ø£ÙŠØ§Ù…", "20 ÙŠÙˆÙ…"], correct: 0 },
                { q: "Ù…Ø§ Ù‡Ùˆ Ø§Ù„Ø¬Ø°Ø± Ø§Ù„ØªØ±Ø¨ÙŠØ¹ÙŠ Ù„Ù€ 144ØŸ", options: ["10", "12", "14"], correct: 1 },
                { q: "Ù…Ø§ Ù‡Ùˆ Ø«Ù„Ø«ÙŠ 90ØŸ", options: ["30", "45", "60"], correct: 2 },
                { q: "100 Ã· (5 Ã— 2) = ØŸ", options: ["10", "20", "5"], correct: 0 },
                { q: "Ø¥Ø°Ø§ ÙƒØ§Ù† Ø³Ø¹Ø± 3 ÙƒØªØ¨ 90 Ø¬Ù†ÙŠÙ‡ØŒ ÙƒÙ… Ø³Ø¹Ø± 7 ÙƒØªØ¨ØŸ", options: ["180", "210", "240"], correct: 1 },
                { q: "25% Ù…Ù† 400ØŸ", options: ["50", "100", "200"], correct: 1 },
                { q: "7 Ã— 9 â€“ 8 = ØŸ", options: ["55", "63", "56"], correct: 0 },
                { q: "18 Ã· 3 Ã— 2 = ØŸ", options: ["3", "12", "6"], correct: 1 },
                { q: "14 + 6 Ã· 3 = ØŸ", options: ["16", "20", "10"], correct: 0 },
                { q: "Ù…Ø§ Ù‡Ùˆ Ø§Ù„Ø¬Ø°Ø± Ø§Ù„ØªÙƒØ¹ÙŠØ¨ÙŠ Ù„Ù€ 27ØŸ", options: ["3", "9", "13"], correct: 0 },
                { q: "Ù…Ø§ Ù‡Ùˆ Ø±Ø¨Ø¹ 200ØŸ", options: ["25", "50", "100"], correct: 1 },
                { q: "3/4 Ù…Ù† 80ØŸ", options: ["40", "60", "20"], correct: 1 },
                { q: "11 Ã— 12 = ØŸ", options: ["122", "132", "142"], correct: 1 },
                { q: "12 Ã— 8 = ØŸ", options: ["86", "96", "106"], correct: 1 },
                { q: "120 Ã· 10 = ØŸ", options: ["10", "12", "14"], correct: 1 },
                { q: "5 Ã— (2 + 3) = ØŸ", options: ["15", "25", "30"], correct: 1 },
                { q: "Ù…Ø§ Ù‡Ùˆ Ø§Ù„Ø¹Ø¯Ø¯ Ø§Ù„Ø°ÙŠ Ù…Ø±Ø¨Ø¹Ù‡ 49ØŸ", options: ["6", "7", "8"], correct: 1 },
                { q: "ÙƒÙ… Ø¯Ù‚ÙŠÙ‚Ø© ÙÙŠ ÙŠÙˆÙ…ØŸ", options: ["1200", "1440", "1800"], correct: 1 },
                { q: "Ù…Ø§ Ù‡Ùˆ Ù†ØµÙ 150ØŸ", options: ["75", "50", "100"], correct: 0 }
            ],
            iq_hard: [
                { q: "Ù…Ø§ Ù‡Ùˆ Ø§Ù„Ø¹Ø¯Ø¯ Ø§Ù„Ù†Ø§Ù‚Øµ: 2 â€“ 5 â€“ 11 â€“ 23 â€“ ØŸ", options: ["35", "47", "50"], correct: 1 },
                { q: "Ø¥Ø°Ø§ ÙƒØ§Ù†: CAT = 24ØŒ DOG = 26 ÙÙƒÙ… ØªØ³Ø§ÙˆÙŠ: BIRD = ØŸ", options: ["30", "35", "40"], correct: 1 },
                { q: "Ù…Ø§ Ù‡Ùˆ Ø§Ù„Ø¹Ø¯Ø¯ Ø§Ù„Ø£ÙˆÙ„ÙŠ Ø¨ÙŠÙ† 50 Ùˆ60ØŸ", options: ["51", "53 Ùˆ59", "57"], correct: 1 },
                { q: "Ø£ÙƒÙ…Ù„ Ø§Ù„Ø³Ù„Ø³Ù„Ø©: 1 â€“ 1 â€“ 2 â€“ 3 â€“ 5 â€“ 8 â€“ ØŸ", options: ["11", "13", "15"], correct: 1 },
                { q: "Ø¹Ø¯Ø¯ Ù…ÙƒÙˆÙ† Ù…Ù† Ø±Ù‚Ù…ÙŠÙ† Ù…Ø¬Ù…ÙˆØ¹Ù‡Ù…Ø§ 12 ÙˆØ§Ù„ÙØ±Ù‚ Ø¨ÙŠÙ†Ù‡Ù…Ø§ 4ØŸ", options: ["7 Ùˆ5", "8 Ùˆ4", "9 Ùˆ3"], correct: 1 },
                { q: "Ù…Ø§ Ù‡Ùˆ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ù…Ø±Ø¨Ø¹ Ù„Ù€ 16ØŸ", options: ["4", "256", "32"], correct: 1 },
                { q: "Ù…Ø§ Ù‡Ùˆ Ù†ØµÙ 0.5 ØŸ", options: ["0.25", "0.1", "1.0"], correct: 0 },
                { q: "8Â² â€“ 4Â² = ØŸ", options: ["32", "48", "64"], correct: 1 },
                { q: "Ù…Ø§ Ù‡Ùˆ Ø§Ù„Ø¹Ø¯Ø¯ Ø§Ù„ØªØ§Ù„ÙŠ: 2 â€“ 6 â€“ 7 â€“ 21 â€“ 22 â€“ ØŸ", options: ["66", "44", "23"], correct: 0 },
                { q: "Ø¥Ø°Ø§ ÙƒØ§Ù† 8 Ø¹Ù…Ø§Ù„ ÙŠÙ†Ø¬Ø²ÙˆÙ† Ø¹Ù…Ù„Ø§Ù‹ ÙÙŠ 4 Ø£ÙŠØ§Ù…ØŒ ÙƒÙ… ÙŠØ­ØªØ§Ø¬ 4 Ø¹Ù…Ø§Ù„ØŸ", options: ["2 ÙŠÙˆÙ…", "8 Ø£ÙŠØ§Ù…", "16 ÙŠÙˆÙ…"], correct: 1 },
                { q: "Ù…Ø§ Ù‡Ùˆ Ø§Ù„Ø¹Ø¯Ø¯ Ø§Ù„ØªØ§Ù„ÙŠ: 1 â€“ 4 â€“ 9 â€“ 16 â€“ ØŸ", options: ["20", "25", "30"], correct: 1 },
                { q: "Ù…Ø§ Ù‡Ùˆ Ø§Ù„Ø¬Ø°Ø± Ø§Ù„ØªØ±Ø¨ÙŠØ¹ÙŠ Ù„Ù€ 196ØŸ", options: ["14", "16", "18"], correct: 0 },
                { q: "ÙƒÙ… Ø£Ø³Ø¨ÙˆØ¹ ØªÙ‚Ø±ÙŠØ¨Ù‹Ø§ ÙÙŠ Ø³Ù†ØªÙŠÙ†ØŸ", options: ["52", "100", "104"], correct: 2 },
                { q: "15Â² = ØŸ", options: ["225", "250", "300"], correct: 0 },
                { q: "Ù…Ø§ Ù‡Ùˆ Ù†Ø§ØªØ¬ 3Â³ + 2Â² ØŸ", options: ["13", "31", "35"], correct: 1 },
                { q: "6Â² + 4Â² = ØŸ", options: ["40", "52", "100"], correct: 1 },
                { q: "5Â³ = ØŸ", options: ["75", "125", "225"], correct: 1 },
                { q: "Ø±Ù‚Ù… Ù„Ùˆ Ù‚Ø³Ù…ØªÙ‡ Ø¹Ù„Ù‰ 4 Ø«Ù… Ø·Ø±Ø­Øª 4 ÙƒØ§Ù† Ø§Ù„Ù†Ø§ØªØ¬ 4ØŸ", options: ["16", "32", "48"], correct: 1 },
                { q: "Ù…Ø§ Ù‡Ùˆ Ù†ØµÙ Ø±Ø¨Ø¹ 160ØŸ", options: ["20", "40", "80"], correct: 0 },
                { q: "Ù…Ø§ Ù‡Ùˆ Ø§Ù„Ø¹Ø¯Ø¯ Ø§Ù„Ø°ÙŠ Ù…Ø±Ø¨Ø¹Ù‡ 169ØŸ", options: ["12", "13", "14"], correct: 1 }
            ]
        };

        function goToMain() {
            let inputEl = document.getElementById('user-name');
            let inputVal = inputEl.value.trim();
            
            if (inputVal === "") {
                sounds.wrong();
                inputEl.style.borderColor = "var(--wrong)";
                inputEl.focus();
                setTimeout(() => { inputEl.style.borderColor = "var(--neon-blue)"; }, 1000);
                return; // Ù…Ù†Ø¹ Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„
            }
            
            userName = inputVal;
            sounds.click();
            document.getElementById('name-view').classList.add('hidden');
            document.getElementById('main-view').classList.remove('hidden');
            document.getElementById('welcome-msg').innerText = "Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ ÙŠØ§ " + userName;
        }

        function switchView(from, to) { sounds.click(); document.getElementById(from).classList.add('hidden'); document.getElementById(to).classList.remove('hidden'); }
        function showLevels() { switchView('main-view', 'levels-view'); }
        function backToMain() { switchView('levels-view', 'main-view'); }

        function showPsyLevels() {
            sounds.click();
            const container = document.getElementById('tests-buttons-container');
            container.innerHTML = "";
            let btn1 = document.createElement('button'); btn1.className = 'btn level-btn'; btn1.innerText = "Ø§Ø®ØªØ¨Ø§Ø± 1";
            btn1.onclick = () => { sounds.click(); switchView('tests-list-view', 'deep-psy-q1'); };
            container.appendChild(btn1);
            let btn2 = document.createElement('button'); btn2.className = 'btn level-btn'; btn2.innerText = "Ø§Ø®ØªØ¨Ø§Ø± 2";
            btn2.onclick = () => { sounds.click(); switchView('tests-list-view', 'psy-traits-view'); };
            container.appendChild(btn2);
            document.getElementById('back-from-list').onclick = () => switchView('tests-list-view', 'main-view');
            document.getElementById('btn-back-to-list').onclick = () => switchView('result-view', 'tests-list-view');
            switchView('main-view', 'tests-list-view');
        }

        function listTests(levelKey) {
            sounds.click();
            currentLevelKey = levelKey;
            const container = document.getElementById('tests-buttons-container');
            container.innerHTML = "";
            const totalQuestions = questionsBank[levelKey].length;
            const numberOfTests = Math.ceil(totalQuestions / 10);
            for (let i = 0; i < numberOfTests; i++) {
                let btn = document.createElement('button'); btn.className = 'btn level-btn'; btn.innerText = `Ø§Ø®ØªØ¨Ø§Ø± ${i + 1}`;
                btn.onclick = () => startSpecificTest(i); container.appendChild(btn);
            }
            document.getElementById('back-from-list').onclick = () => switchView('tests-list-view', 'levels-view');
            document.getElementById('btn-back-to-list').onclick = () => switchView('result-view', 'tests-list-view');
            switchView('levels-view', 'tests-list-view');
        }

        function startSpecificTest(testIdx) {
            sounds.click();
            currentIdx = 0; score = 0; wrongAnswers = [];
            activeQuestions = questionsBank[currentLevelKey].slice(testIdx * 10, (testIdx * 10) + 10);
            switchView('tests-list-view', 'quiz-view');
            loadQuestion();
        }

        function loadQuestion() {
            let qData = activeQuestions[currentIdx];
            document.getElementById('question-text').innerText = qData.q;
            document.getElementById('q-num').innerText = currentIdx + 1;
            let optionsDiv = document.getElementById('options-container');
            optionsDiv.innerHTML = "";
            qData.options.forEach((opt, index) => {
                let btn = document.createElement('button'); btn.className = 'btn'; btn.innerText = opt;
                btn.onclick = () => checkAnswer(index, btn); optionsDiv.appendChild(btn);
            });
        }

        function checkAnswer(choice, btn) {
            let qData = activeQuestions[currentIdx];
            document.querySelectorAll('#options-container .btn').forEach(b => b.style.pointerEvents = 'none');
            if (choice === qData.correct) { btn.classList.add('correct-glow'); sounds.correct(); score++; }
            else { btn.classList.add('wrong-glow'); sounds.wrong(); wrongAnswers.push({ q: qData.q, correct: qData.options[qData.correct] }); }
            setTimeout(() => { currentIdx++; if (currentIdx < activeQuestions.length) loadQuestion(); else showResults(); }, 700);
        }

        function showResults() {
            sounds.success();
            document.getElementById('quiz-view').classList.add('hidden');
            document.getElementById('result-view').classList.remove('hidden');
            let analysisBox = document.getElementById('analysis-text');
            let reportContainer = document.getElementById('report-container');
            reportContainer.innerHTML = "";
            let percent = (score / activeQuestions.length) * 100;
            document.getElementById('score-header').innerText = "Ø§Ù„Ø¯Ø±Ø¬Ø©: " + percent + "%";
            let msg = (percent >= 90) ? "Ù‡Ù†Ø§Ùƒ Ø²ÙˆÙŠÙ„ Ø¬Ø¯ÙŠØ¯ ğŸ¤ğŸ˜…ğŸ‘ŒğŸ»" : (percent >= 80) ? "Ø§ÙŠ Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø®Ø§Ø±Ù‚ Ø¯Ù‡ Ø¨Ø±Ù†Ø³ğŸ‘ŒğŸ»ğŸ˜…" : (percent > 60) ? "Ø¬Ø¯Ø¹ ÙŠØ§Ø¨Ø§Ø´Ø§â˜ºï¸" : (percent == 50) ? "ÙƒÙˆÙŠØ³ Ø¨Ø³ Ø´Ø¯ Ø­ÙŠÙ„Ùƒ Ø§Ù„Ù…Ø±Ù‡ Ø§Ù„Ø¬Ø§ÙŠÙ‡â˜ºï¸" : (percent >= 30) ? "Ø¹Ù‚Ù„Ùƒ Ø±Ø§ÙŠØ­ ÙÙŠÙ† ğŸ™„â˜ºï¸" : "Ø±ÙˆØ­ Ø¯ÙˆØ± Ø¹Ù„Ù‰ Ø¹Ù‚Ù„Ùƒ ÙˆØªØ¹Ø§Ù„Ù‰ ØªØ§Ù†ÙŠ ğŸ˜‚";
            analysisBox.innerHTML = `ÙŠØ§ ${userName}ØŒ ${msg}`;
            if (wrongAnswers.length > 0) {
                let html = "<h3 style='color:var(--wrong)'>Ø§Ù„Ø£Ø®Ø·Ø§Ø¡ ÙˆØªØµØ­ÙŠØ­Ù‡Ø§:</h3>";
                wrongAnswers.forEach(item => html += `<div class="report-item">â“ ${item.q}<br>âœ… Ø§Ù„Ø­Ù„: ${item.correct}</div>`);
                reportContainer.innerHTML = html;
            }
        }

        function showTraitsResults() {
            sounds.success();
            document.getElementById('psy-traits-view').classList.add('hidden');
            document.getElementById('result-view').classList.remove('hidden');
            document.getElementById('score-header').innerText = "Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù†ÙØ³ÙŠ 2";
            document.getElementById('analysis-text').innerHTML = `
                <div style="text-align:right">
                    <div class="psy-item">ÙˆØµÙÙƒ Ù„Ù„Ø­ÙŠÙˆØ§Ù† 1 (<b>${document.getElementById('t-anim1').value}</b>): Ù†Ø¸Ø±ØªÙƒ Ù„Ù†ÙØ³Ùƒ.</div>
                    <div class="psy-item">ÙˆØµÙÙƒ Ù„Ù„Ø­ÙŠÙˆØ§Ù† 2 (<b>${document.getElementById('t-anim2').value}</b>): Ù†Ø¸Ø±Ø© Ø§Ù„Ù†Ø§Ø³ Ù„Ùƒ.</div>
                    <div class="psy-item">ÙˆØµÙÙƒ Ù„Ù„Ø­ÙŠÙˆØ§Ù† 3 (<b>${document.getElementById('t-anim3').value}</b>): ÙƒÙŠÙ ØªØ¨ÙŠ ØªÙƒÙˆÙ†.</div>
                    <div class="psy-item">ÙˆØµÙÙƒ Ù„Ù„Ø¬Ø¯Ø§Ø± (<b>${document.getElementById('t-wall').value}</b>): Ù†Ø¸Ø±ØªÙƒ Ù„Ù„Ù…ÙˆØª.</div>
                    <div class="psy-item">ÙˆØµÙÙƒ Ù„Ù„Ø¨Ø¦Ø± (<b>${document.getElementById('t-well').value}</b>): Ù†Ø¸Ø±ØªÙƒ Ù„Ù„Ù€Ø¬Ù€Ù†Ù€Ø³.</div>
                    <div class="psy-item">ÙˆØµÙÙƒ Ù„Ù„Ø¨Ø­Ø± (<b>${document.getElementById('t-sea2').value}</b>): Ù†Ø¸Ø±ØªÙƒ Ù„Ù„Ø­ÙŠØ§Ø©.</div>
                </div>`;
        }

        function selectAnimal(animal, el) {
            if (!deepAnimalOrder.includes(animal)) {
                deepAnimalOrder.push(animal); el.classList.add('selected');
                document.getElementById('user-order-display').innerText = "ØªØ±ØªÙŠØ¨Ùƒ: " + deepAnimalOrder.join(" â† ");
                if (deepAnimalOrder.length === 5) document.getElementById('btn-to-psy2').classList.remove('hidden');
            }
        }

        function showDeepResults() {
            sounds.success();
            document.getElementById('deep-psy-q3').classList.add('hidden');
            document.getElementById('result-view').classList.remove('hidden');
            document.getElementById('score-header').innerText = "Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù†ÙØ³ÙŠ 1";
            const animalMap = { "Ø­ØµØ§Ù†": "Ø§Ù„Ø¹Ø§Ø¦Ù„Ø©", "Ø®Ø±ÙˆÙ": "Ø§Ù„Ø­Ø¨", "Ø¨Ù‚Ø±Ø©": "Ø§Ù„Ø¹Ù…Ù„", "Ù†Ù…Ø±": "Ø¹Ø²Ø© Ø§Ù„Ù†ÙØ³", "Ø®Ù†Ø²ÙŠØ±": "Ø§Ù„Ù…Ø§Ù„" };
            let html = `<div style="text-align:right"><h3>ØªØ­Ù„ÙŠÙ„Ùƒ Ø§Ù„Ø´Ø®ØµÙŠ ÙŠØ§ ${userName}:</h3>`;
            deepAnimalOrder.forEach((a, i) => html += `<div class="psy-item">Ù…Ø±ÙƒØ² ${i+1}: ${a} (ÙŠØ¯Ù„ Ø¹Ù„Ù‰ <b>${animalMap[a]}</b>)</div>`);
            html += `<div class="psy-item">Ø§Ù„ÙƒÙ„Ø¨ Ù‡Ùˆ: <b>${document.getElementById('psy-dog').value}</b> (ÙŠØ¯Ù„ Ø¹Ù„Ù‰ ÙˆØµÙÙƒ Ù„Ù†ÙØ³Ùƒ)</div>`;
            html += `<div class="psy-item">Ø§Ù„Ù‚Ø·Ø© Ù‡ÙŠ: <b>${document.getElementById('psy-cat').value}</b> (ÙŠØ¯Ù„ Ø¹Ù„Ù‰ ÙˆØµÙÙƒ Ù„Ø´Ø±ÙŠÙƒ Ø­ÙŠØ§ØªÙƒ)</div>`;
            html += `<div class="psy-item">Ø§Ù„ÙØ£Ø± Ù‡Ùˆ: <b>${document.getElementById('psy-rat').value}</b> (ÙŠØ¯Ù„ Ø¹Ù„Ù‰ ÙˆØµÙÙƒ Ù„Ø£Ø¹Ø¯Ø§Ø¦Ùƒ)</div>`;
            html += `<div class="psy-item">Ø§Ù„Ù‚Ù‡ÙˆØ© Ù‡ÙŠ: <b>${document.getElementById('psy-coffee').value}</b> (ÙŠØ¯Ù„ Ø¹Ù„Ù‰ Ù†Ø¸Ø±ØªÙƒ Ù„Ù„Ø¬Ù€Ù†Ù€Ø³)</div>`;
            html += `<div class="psy-item">Ø§Ù„Ø¨Ø­Ø± Ù‡Ùˆ: <b>${document.getElementById('psy-sea').value}</b> (ÙŠØ¯Ù„ Ø¹Ù„Ù‰ Ù†Ø¸Ø±ØªÙƒ Ù„Ø­ÙŠØ§ØªÙƒ)</div>`;
            html += `<hr style="opacity:0.2">`;
            html += `<div class="psy-item">Ø§Ù„Ø£ØµÙØ±: <b>${document.getElementById('psy-yellow').value}</b> (Ø´Ø®Øµ Ù„Ø§ ØªÙ†Ø³Ø§Ù‡ Ø£Ø¨Ø¯Ø§Ù‹)</div>`;
            html += `<div class="psy-item">Ø§Ù„Ø¨Ø±ØªÙ‚Ø§Ù„ÙŠ: <b>${document.getElementById('psy-orange').value}</b> (ØµØ¯ÙŠÙ‚ ÙˆÙÙŠ Ø­Ù‚Ø§Ù‹)</div>`;
            html += `<div class="psy-item">Ø§Ù„Ø£Ø­Ù…Ø±: <b>${document.getElementById('psy-red').value}</b> (Ø´Ø®Øµ ØªØ­Ø¨Ù‡ Ø¨ØµØ¯Ù‚)</div>`;
            html += `<div class="psy-item">Ø§Ù„Ø£Ø¨ÙŠØ¶: <b>${document.getElementById('psy-white').value}</b> (ØªÙˆØ£Ù… Ø±ÙˆØ­Ùƒ)</div>`;
            html += `<div class="psy-item">Ø§Ù„Ø£Ø®Ø¶Ø±: <b>${document.getElementById('psy-green').value}</b> (Ø´Ø®Øµ Ø³ØªØªØ°ÙƒØ±Ù‡ Ø¯Ø§Ø¦Ù…Ø§Ù‹)</div></div>`;
            document.getElementById('analysis-text').innerHTML = html;
        }

        function forceBackToHome() {
            sounds.click();
            document.querySelectorAll('.card').forEach(c => c.classList.add('hidden'));
            document.getElementById('main-view').classList.remove('hidden');
            deepAnimalOrder = [];
            document.querySelectorAll('.order-btn').forEach(b => b.classList.remove('selected'));
            document.getElementById('user-order-display').innerText = "";
            document.getElementById('btn-to-psy2').classList.add('hidden');
            document.querySelectorAll('input[type="text"]').forEach(input => { if(input.id !== 'user-name') input.value = ""; });
        }
    </script>
</body>
</html>
